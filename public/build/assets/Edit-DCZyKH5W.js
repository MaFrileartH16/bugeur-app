import{b as y,j as r,T as A,S as C,H as v,c as S}from"./app-l3PHe4uA.js";import{I as E,b as T,A as I,C as D,T as p}from"./AppLayout-C8W-FPwP.js";import{T as F}from"./Textarea-BF3NX1nc.js";import{I as M}from"./IconAlignJustified-Bb4jN-MM.js";import{I as q}from"./IconUsers-CKgdAAUf.js";import{G as o}from"./Grid-ytByML-q.js";const G=l=>{console.log(l);const{user:h}=l.auth,{project:i,managers:b,users:d}=l,e=y({title:i.title,description:i.description,manager_id:i.manager_id,team_members:i.working_on.map(t=>t.id)}),f=t=>{const a=d.filter(m=>t.includes(m.id)),n=a.some(m=>m.role==="Developer"),s=a.some(m=>m.role==="Quality Assurance");return!n&&!s?"At least one Developer and one Quality Assurance are required.":n?s?null:"At least one Quality Assurance is required.":"At least one Developer is required."},u=(t,a)=>t==="team_members"?f(a):!a||Array.isArray(a)&&a.length===0?`${t.replace("_"," ").replace(/\b\w/g,s=>s.toUpperCase())} is required.`:null,c=t=>a=>{const n=a.target?a.target.value:a;e.setData(t,n);const s=u(t,n);s?e.setError(t,s):e.clearErrors(t)},g=t=>{t.preventDefault();const a=u("team_members",e.data.team_members);if(a){e.setError("team_members",a);return}e.put(route("projects.update",i.id),{onFinish:()=>e.reset()})},j=!e.data.title||!e.data.description||!e.data.manager_id||e.data.team_members.length===0,x=[{label:"Title",value:e.data.title,onChange:c("title"),error:e.errors.title,placeholder:"Enter the project's title",leftSection:r.jsx(E,{}),component:A},{label:"Description",value:e.data.description,onChange:c("description"),error:e.errors.description,placeholder:"Enter the project's description",component:F,leftSection:r.jsx(M,{}),minRows:4},{label:"Manager",defaultValue:e.data.manager_id,onChange:c("manager_id"),error:e.errors.manager_id,placeholder:"Select a manager",leftSection:r.jsx(T,{}),component:C,data:b.map(t=>({value:t.id,label:t.full_name}))},{label:"Team Members",value:e.data.team_members,onChange:c("team_members"),error:e.errors.team_members,placeholder:"Select team members",leftSection:r.jsx(q,{}),component:v,data:d.map(t=>({value:t.id,label:`${t.full_name} (${t.role})`})),nothingFoundMessage:"No team members found."}],_=Object.keys(e.errors).length>0;return r.jsx("form",{onSubmit:g,children:r.jsx(I,{title:l.title,user:h,children:r.jsxs(D,{flex:1,size:"xl",w:"100%",py:32,children:[r.jsx(p,{mb:32,children:l.title}),r.jsxs(o,{gutter:16,justify:"flex-end",children:[x.map(({component:t,label:a,...n},s)=>r.jsx(o.Col,{span:{base:12},children:r.jsxs(o,{gutter:{base:8,sm:0},align:"center",children:[r.jsx(o.Col,{span:{base:12,sm:4},children:r.jsx(p,{order:5,children:a})}),r.jsx(o.Col,{span:{base:12,sm:8},children:r.jsx(t,{...n})})]})},s)),r.jsx(o.Col,{span:{base:12,sm:8,smOffset:4},children:r.jsx(S,{type:"submit",fullWidth:!0,disabled:e.processing||_||j,loading:e.processing,children:"Update Project"})})]})]})})})};export{G as default};
